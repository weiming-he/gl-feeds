--- a/iwinfo_lua.c
+++ b/iwinfo_lua.c
@@ -479,16 +479,22 @@ static int iwinfo_L_freqlist(lua_State *
 	char rv[IWINFO_BUFSIZE];
 	const char *ifname = luaL_checkstring(L, 1);
 	struct iwinfo_freqlist_entry *e;
+	bool dfs_support;
 
 	lua_newtable(L);
 	memset(rv, 0, sizeof(rv));
 
 	if (!(*func)(ifname, rv, &len))
 	{
-		for (i = 0, x = 1; i < len; i += sizeof(struct iwinfo_freqlist_entry), x++)
+		dfs_support = access("/proc/gl-hw-info/dfs", R_OK) == 0;
+
+		for (i = 0, x = 1; i < len; i += sizeof(struct iwinfo_freqlist_entry))
 		{
 			e = (struct iwinfo_freqlist_entry *) &rv[i];
 
+			if (!dfs_support && e->channel > 48 && e->channel < 149)
+				continue;
+
 			lua_newtable(L);
 
 			/* MHz */
@@ -503,7 +509,7 @@ static int iwinfo_L_freqlist(lua_State *
 			lua_pushboolean(L, e->restricted);
 			lua_setfield(L, -2, "restricted");
 
-			lua_rawseti(L, -2, x);
+			lua_rawseti(L, -2, x++);
 		}
 	}
 
